(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[25],{"+H1k":function(e,n,t){"use strict";t.r(n);t("n5y/");var a=t("6FWG"),c=(t("pS3q"),t("bdaH")),r=(t("Kylo"),t("e9KH")),u=(t("1/+H"),t("hTDs")),o=(t("nYMg"),t("P7cs")),i=(t("eDB0"),t("KK+S")),d=(t("bM0/"),t("GINK")),l=t("wS/U"),m=t("ZZRV"),h=t.n(m),s=t("sACR"),p=t("LneV"),b=t("4Mzt"),f=(t("rTa6"),t("ThRD")),g=(t("6bfg"),t("S19n")),k=(t("l6gx"),t("fVAk")),O=t("K6Fx"),j=t("IqgA"),v=t("p8cf"),E=(t("ni22"),t("3GnR")),I=t("IWSt"),y=t.n(I),C=20,P=250;function A(e){var n=e.permissionTree,t=e.checkedMenu,a=e.checkedAPI,c=e.onMenuChange,r=e.onAPIChange,u=e.disabled,o=void 0!==u&&u,i={};return t.map((function(e){i[e]=!0})),h.a.createElement(E["b"],{bordered:!0,split:!0,className:y.a.menuTree},h.a.createElement(E["b"].Item,null,h.a.createElement("div",{style:{width:"100%",textAlign:"center",display:"grid",gridTemplateColumns:P+"px auto"}},h.a.createElement("div",null,"\u83dc\u5355"),h.a.createElement("div",{style:{borderLeft:"1px solid #eee"}},"API\u6743\u9650"))),n.map((function(n){return h.a.createElement(E["b"].Item,{key:n.path},h.a.createElement(_,Object(j["a"])({disabled:o,checkedAPI:a,checked:t.indexOf(n.path)>-1,menuPath:[],checkedMenu:e.checkedMenu},n,{onAPIChange:function(e){var n=a.filter((function(n){return e.findIndex((function(e){return!e.checked&&e.method==n.method&&e.path==n.path}))<0}));n.push.apply(n,Object(v["a"])(e.filter((function(e){return e.checked})))),r(n)},onMenuChange:function(e){e.map((function(e){i[e.path]=e.checked})),c(Object.keys(i).filter((function(e){return i[e]})).map((function(e){return e})))},depth:0})))})))}function _(e){var n,t=e.depth,a=C*t,c=P-a;return h.a.createElement("div",{className:y.a.menuItem,style:{paddingLeft:C*t+"px"}},h.a.createElement("div",{className:y.a.menuItemContainer,style:{gridTemplateColumns:c+"px auto"}},h.a.createElement("div",null,h.a.createElement(k["a"],{disabled:e.disabled,checked:e.checked,onChange:function(n){if(n.target.checked){e.onMenuChange([].concat(Object(v["a"])(e.menuPath.map((function(e){return{path:e,checked:!0}}))),[{path:e.path,checked:!0}],Object(v["a"])((e.children||[]).map((function(e){return{path:e.path,checked:!0}})))));var t=e.api||[],a=function e(n){var t=[];return n.map((function(n){t.push.apply(t,Object(v["a"])(n.api)),n.children&&t.push.apply(t,Object(v["a"])(e(n.children)))})),t};t.push.apply(t,Object(v["a"])(a(e.children||[]))),e.onAPIChange(Object(v["a"])(t.map((function(e){return Object(O["a"])(Object(O["a"])({},e),{},{checked:!0})}))))}else e.onMenuChange([{path:e.path,checked:!1}].concat(Object(v["a"])((e.children||[]).map((function(e){return{path:e.path,checked:!1}})))))}},e.name)),h.a.createElement("div",null,null===(n=e.api)||void 0===n?void 0:n.map((function(n){var t=!1;return e.checkedAPI.map((function(e){e.method===n.method&&e.path===n.path&&(t=!0)})),h.a.createElement("span",{key:n.path+" "+n.method},h.a.createElement(k["a"],{disabled:e.disabled,checked:t,onChange:function(t){e.onAPIChange([Object(O["a"])(Object(O["a"])({},n),{},{checked:t.target.checked})])}},h.a.createElement(f["a"],{title:n.name,content:h.a.createElement("span",null,h.a.createElement(g["a"],{color:"success"},n.method)," ",n.path)},h.a.createElement("span",null,n.name))))})))),h.a.createElement("div",null,(e.children||[]).map((function(n){return h.a.createElement(_,Object(j["a"])({key:n.path,disabled:e.disabled,checkedAPI:e.checkedAPI,onAPIChange:e.onAPIChange,checked:e.checkedMenu.indexOf(n.path)>-1,checkedMenu:e.checkedMenu,onMenuChange:e.onMenuChange,menuPath:[].concat(Object(v["a"])(e.menuPath),[e.path])},n,{depth:t+1}))}))))}var M=A,x=function(e){var n=e.userGroups,t=(e.menu,e.dispatch),p=Object(m["useState"])([]),f=Object(l["a"])(p,2),g=f[0],k=f[1],O=Object(m["useState"])([]),j=Object(l["a"])(O,2),v=j[0],E=j[1],I=Object(m["useState"])("admin"),y=Object(l["a"])(I,2),C=y[0],P=y[1],A=Object(m["useState"])([]),_=Object(l["a"])(A,2),x=_[0],S=_[1],T=Object(m["useState"])(0),G=Object(l["a"])(T,2),w=G[0],K=G[1],H="admin"===C,L=function(e){var n=2;P(e),K(2),Object(b["e"])(e).then((function(e){14e3!==e.code&&(0===e.code?(K(--n),k(e.data||[])):d["a"].error("\u52a0\u8f7d\u83dc\u5355\u6743\u9650\u5931\u8d25:"+e.msg))})),Object(b["d"])(e).then((function(e){0===e.code?(K(--n),E(e.data||[])):d["a"].error("\u52a0\u8f7dAPI\u6743\u9650\u5931\u8d25:"+e.msg)}))};Object(m["useEffect"])((function(){t({type:"userGroup/fetch"}),L("admin"),Object(b["c"])().then((function(e){0===e.code||14e3===e.code?S(e.data):d["a"].error("\u52a0\u8f7d\u6743\u9650\u6811\u5931\u8d25:"+e.msg)}))}),[]);var N=function(){console.log(g,v),d["a"].loading({content:"\u6b63\u5728\u4fdd\u5b58\u83dc\u5355\u6743\u9650",key:"message_save_menu"}),d["a"].loading({content:"\u6b63\u5728\u4fdd\u5b58API\u6743\u9650",key:"message_save_api"}),Object(b["j"])(C,g).then((function(e){0!==e.code&&d["a"].error({content:"\u4fdd\u5b58\u83dc\u5355\u6743\u9650\u5931\u8d25: "+e.msg,key:"message_save_menu",duration:2}),d["a"].success({content:"\u83dc\u5355\u6743\u9650\u4fdd\u5b58\u6210\u529f",key:"message_save_menu",duration:2})})),Object(b["h"])(C,v).then((function(e){0!==e.code&&d["a"].error({content:"\u4fdd\u5b58API\u6743\u9650\u5931\u8d25: "+e.msg,key:"message_save_api",duration:2}),d["a"].success({content:"\u4fdd\u5b58API\u6743\u9650\u6210\u529f",key:"message_save_api",duration:2})}))};return h.a.createElement(s["b"],null,h.a.createElement(a["a"],{style:{minHeight:"600px"}},h.a.createElement(o["a"],null,h.a.createElement(r["a"],null,h.a.createElement(o["a"].Item,{label:"\u7528\u6237\u7ec4"},h.a.createElement(i["a"],{style:{width:"120px"},onSelect:L,value:C},n.map((function(e){return h.a.createElement(i["a"].Option,{value:e.name,key:e.name},e.name)})))),h.a.createElement(u["a"],{style:{marginLeft:"10px"},onClick:N,disabled:H},"\u66f4\u65b0")),h.a.createElement("div",{style:{marginTop:"10px"}},h.a.createElement(c["a"],{spinning:0!==w,tip:"\u52a0\u8f7d\u6743\u9650\u4e2d"},h.a.createElement(M,{disabled:H,onMenuChange:function(e){k(e),console.log(e)},onAPIChange:function(e){E(e),console.log(e)},checkedMenu:g,checkedAPI:v,permissionTree:x}))))))},S=function(e){var n=e.userGroup,t=e.global;return{userGroups:n.userGroups,menu:t.menu}};n["default"]=Object(p["connect"])(S)(x)},IWSt:function(e,n,t){e.exports={menuTree:"menuTree___1raGy",menuItem:"menuItem___11bfG",menuItemContainer:"menuItemContainer___1VvjO"}}}]);